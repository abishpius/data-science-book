import{_ as a,c as i,o as e,ae as t}from"./chunks/framework.CDjunVez.js";const c=JSON.parse('{"title":"Chapter 3: Mastering Data Manipulation with Pandas","description":"","frontmatter":{},"headers":[],"relativePath":"chapters/chapter-3.md","filePath":"chapters/chapter-3.md"}'),n={name:"chapters/chapter-3.md"};function l(h,s,p,o,r,k){return e(),i("div",null,[...s[0]||(s[0]=[t(`<h1 id="chapter-3-mastering-data-manipulation-with-pandas" tabindex="-1">Chapter 3: Mastering Data Manipulation with Pandas <a class="header-anchor" href="#chapter-3-mastering-data-manipulation-with-pandas" aria-label="Permalink to &quot;Chapter 3: Mastering Data Manipulation with Pandas&quot;">â€‹</a></h1><p>The DataFrame: Moving Beyond Excel Tables If you asked a carpenter to build a house using only a Swiss Army knife, they might eventually succeed, but it would be exhausting, inefficient, and structurally unsound. For years, Excel has been the Swiss Army knife of data analysis. It is versatile, approachable, and ubiquitous. However, as you transition into Data Science, you are moving from building sheds to building skyscrapers. You need heavy machinery. In Python, that machinery is Pandas. Pandas (derived from &quot;Panel Data&quot;) is the bedrock of Python data science. It provides a high-performance structure that allows you to manipulate structured data programmatically. While basic Python lists and dictionaries (covered in the previous section) are useful for small tasks, they lack the specific tooling required to slice, dice, aggregate, and visualize millions of rows of data instantly. The Mental Shift: From Spreadsheets to DataFrames The core object in Pandas is the DataFrame. At first glance, a DataFrame looks exactly like an Excel spreadsheet. It has rows, it has columns, and it holds data. A split-screen comparison. On the left, a screenshot of Microsoft Excel showing a table with columns &quot;Date&quot;, &quot;Region&quot;, and &quot;Sales&quot;. On the right, a stylized representation of a Pandas DataFrame output in a Jupyter Notebook showing the exact same data. Arrows connect the Excel row numbers to the Pandas &quot;Index&quot;, and Excel column letters to Pandas &quot;Column Names&quot;.</p><p>A split-screen comparison. On the left, a screenshot of Microsoft Excel showing a table with columns &quot;Date&quot;, &quot;Region&quot;, and &quot;Sales&quot;. On the right, a stylized representation of a Pandas DataFrame output in a Jupyter Notebook showing the exact same data. Arrows connect the Excel row numbers to the Pandas &quot;Index&quot;, and Excel column letters to Pandas &quot;Column Names&quot;. However, the similarity is deceptively superficial. In a spreadsheet, the data and the interface are the same thing. You click on a cell to change it. You see all your data at once. In Pandas, the DataFrame is a data structure held in your computer&#39;s memory. You do not &quot;look&quot; at the whole thing constantly; you write code to query it, modify it, and summarize it. To begin using this tool, we first need to import the library. By universal convention in the data science community, Pandas is imported with the alias pd.</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pandas </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pd</span></span></code></pre></div><p>Anatomy of a DataFrame To master the DataFrame, you must understand its three structural components. If you treat it just like a grid of cells, you will struggle. If you treat it as a collection of these three parts, you will thrive.</p><ol><li>The Data: The actual values (integers, floats, strings, etc.). 2. The Columns: The labels for your data variables (e.g., &quot;Price&quot;, &quot;Quantity&quot;). 3. The Index: The labels for your rows. A technical diagram breaking down a DataFrame. It shows a central block of data grid. Top horizontal bar is highlighted as &quot;Columns (Axis 1)&quot;. The left vertical bar is highlighted as &quot;Index (Axis 0)&quot;. The intersection of a column and index is highlighted as &quot;Data Point&quot;.</li></ol><p>A technical diagram breaking down a DataFrame. It shows a central block of data grid. Top horizontal bar is highlighted as &quot;Columns (Axis 1)&quot;. The left vertical bar is highlighted as &quot;Index (Axis 0)&quot;. The intersection of a column and index is highlighted as &quot;Data Point&quot;.</p><ol><li>Series: The Building Blocks Recall the &quot;Lists&quot; we discussed in the previous section. If a DataFrame is a table, what is a single column? In Pandas, a single column is called a Series. You can think of a DataFrame as a Dictionary where every key is a column name, and every value is a Series (a specialized list) of equal length. Let&#39;s create a DataFrame from scratch using the concepts you learned in the previous chapterâ€”dictionaries and listsâ€”to see how they fuse together.</li></ol><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pandas </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pd</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># A dictionary where keys are column headers and values are lists of data</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">data </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;Product_ID&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;A101&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;A102&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;A103&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;A104&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;Category&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Electronics&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Furniture&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Electronics&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Office&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;Price&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">500</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">150</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1200</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">45</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Converting the dictionary into a DataFrame</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pd.read_csv(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;data.csv&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Common in practice, but for now we build manually:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pd.DataFrame(data)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(df)</span></span></code></pre></div><p><strong>Output:</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span></span></span>
<span class="line"><span>\`\`\`text</span></span>
<span class="line"><span>Product_ID     Category  Price</span></span>
<span class="line"><span>0       A101  Electronics    500</span></span>
<span class="line"><span>1       A102    Furniture    150</span></span>
<span class="line"><span>2       A103  Electronics   1200</span></span>
<span class="line"><span>3       A104       Office     45</span></span>
<span class="line"><span>2. The Index: More Than Just Row Numbers Notice the numbers 0, 1, 2, 3 on the far left of the output above? This is the Index.</span></span></code></pre></div><p>In Excel, row numbers (1, 2, 3...) are fixed physical locations. If you sort the data, the data moves, but row 5 is always row 5. In Pandas, the Index travels with the row. It acts as a unique identifier for that observation. Crucially, the Index doesn&#39;t have to be a number. It can be a Date, a Transaction ID, or a Customer Name. This allows for powerful lookups without complex VLOOKUP or INDEX-MATCH formulas. Decoupling Logic from Presentation The hardest habit to break when moving from Excel to Pandas is the desire to &quot;see&quot; the change happen instantly. In Excel, if you want to calculate Revenue, you click a cell, type =B2*C2, and drag the fill handle down. You watch the numbers populate. In Pandas, you perform this operation using Vectorization. You don&#39;t write a loop to go through row by row (like a manual drag); you apply an operation to the entire array at once.</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Assume we have a &#39;Quantity&#39; column</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># In Excel: =B2 * C2 applied to every row</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># In Pandas:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Revenue&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> df[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Price&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> df[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Quantity&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span></code></pre></div><p>This single line of code applies the logic to one thousand rows or one billion rows instantly. Why Make the Switch? If Pandas requires writing code to do what a mouse click can do in Excel, why bother?</p><ol><li>Scale: Excel begins to struggle around 50,000 rows and often crashes near 1 million. Pandas can handle millions (and even gigabytes) of rows in memory with ease. 2. Reproducibility: In a spreadsheet, it is difficult to audit how a number changed from 500 to 450â€”was it a formula change? A manual overwrite? In Pandas, every change is a line of code. You can read the &quot;recipe&quot; of your analysis from top to bottom. 3. Data Integrity: In Excel, it is dangerously easy to accidentally type 7 into a cell that should contain a date. Pandas enforces data types (integers, floats, timestamps) more strictly, alerting you to data quality issues before they taint your final report. In the coming sections, we will move away from creating manual DataFrames and learn to ingest real-world data from CSVs, databases, and APIs, treating the DataFrame not just as a grid, but as a canvas for insight. Ingesting Data: Reading CSV, Excel, and SQL Sources Think of your Python script as a high-end manufacturing plant. In the previous section, we installed the machinery (the Pandas library) and learned about the final product (the DataFrame). However, a factory cannot function without raw materials. In the Excel world, &quot;ingesting&quot; data is intuitive: you double-click a file icon, and the application opens it. You see the data immediately. In Data Science, the process is slightly more deliberate. You do not &quot;open&quot; a file; you read it into memory. Your Python script sits in one location, and your data sits in another (a folder, a server, or the cloud). You must build a bridge between the two. Fortunately, Pandas provides a suite of I/O (Input/Output) tools that act as these bridges. Almost all of them follow a consistent naming convention: pd.read_format(). A conceptual diagram showing a Python script in the center. On the left, three distinct data sources: a CSV file icon, an Excel file icon, and a Database cylinder. Arrows flow from these sources into the Python script. Each arrow is labeled with its specific function: <code>pd.read_csv()</code>, <code>pd.read_excel()</code>, and <code>pd.read_sql()</code>. The arrows converge into a tabular grid labeled &quot;DataFrame&quot;.</li></ol><p>A conceptual diagram showing a Python script in the center. On the left, three distinct data sources: a CSV file icon, an Excel file icon, and a Database cylinder. Arrows flow from these sources into the Python script. Each arrow is labeled with its specific function: <code>pd.read_csv()</code>, <code>pd.read_excel()</code>, and <code>pd.read_sql()</code>. The arrows converge into a tabular grid labeled &quot;DataFrame&quot;. The Universal Standard: Reading CSV Files The Comma Separated Values (CSV) format is the lingua franca of data science. It is text-based, lightweight, and can be exported from almost any software system in the world. Because it strips away formattingâ€”no bold text, no cell colors, no formulasâ€”it is the cleanest way to transfer raw data. To load a CSV, we use pd.read_csv().</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pandas </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pd</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># The simplest form of data ingestion</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pd.read_csv(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;sales_data.csv&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Display the first few rows to verify</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(df.head())</span></span></code></pre></div><p>Handling Real-World CSV Issues In a perfect world, every CSV is formatted correctly with commas separating columns and the first row containing headers. In reality, you will often receive &quot;messy&quot; exports from legacy systems. Imagine you receive a file exported from a European system where they use semi-colons (ðŸ˜‰ instead of commas to separate values, or a file where the first three rows contain legal disclaimers before the actual column headers start. Pandas allows you to configure the &quot;reader&quot; to handle these quirks using parameters.</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Reading a messy file</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pd.read_csv(</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;raw_export_v2.csv&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    sep</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;;&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,            </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Tell Pandas the separator is a semi-colon, not a comma</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    header</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,           </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># The actual column names are on the 4th row (index 3)</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    encoding</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;utf-8&#39;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # Ensure special characters (like currency symbols) read correctly</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> A split</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">screen visual. On the left, a screenshot of a raw text editor showing data separated by semi</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">colons </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">with</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> legal text </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> the top rows. On the right, the resulting clean Pandas DataFrame. Between them, a callout box listing the parameters used: </span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">\`sep=</span><span style="--shiki-light:#032F62;--shiki-light-font-style:italic;--shiki-dark:#9ECBFF;--shiki-dark-font-style:italic;">&#39;;&#39;</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">\`</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> and</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;"> \`header=</span><span style="--shiki-light:#005CC5;--shiki-light-font-style:italic;--shiki-dark:#79B8FF;--shiki-dark-font-style:italic;">3</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">\`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span></span></code></pre></div><p>A split-screen visual. On the left, a screenshot of a raw text editor showing data separated by semi-colons with legal text in the top rows. On the right, the resulting clean Pandas DataFrame. Between them, a callout box listing the parameters used: <code>sep=&#39;;&#39;</code> and <code>header=3</code>. The Corporate Standard: Reading Excel Files As a transitioning professional, a significant portion of your organization&#39;s historical knowledge is likely locked inside .xlsx files. While Excel is great for viewing data, it is heavy. It contains formatting, metadata, and multiple sheets. To read these files, we use pd.read_excel(). Unlike CSVs, an Excel file is a workbook that acts as a folder for multiple tables (sheets). If you do not specify a sheet, Pandas will default to reading the first one. To target specific data, you utilize the sheet_name parameter.</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Load the entire workbook file path</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">file_path </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;Quarterly_Financials.xlsx&#39;</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Read a specific tab named &#39;Q3_Transactions&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">q3_data </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pd.read_excel(file_path, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">sheet_name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Q3_Transactions&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># You can also read sheets by their index position (0 is the first sheet)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># This is useful if the sheet names change month-to-month but the order stays the same</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">first_sheet </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pd.read_excel(file_path, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">sheet_name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Note: Reading Excel files is significantly slower than reading CSV files because Python must parse the complex XML structure behind the .xlsx format. If you have a choice between a 50MB Excel file and a 50MB CSV file, always choose the CSV for performance. The Enterprise Bridge: Reading from SQL As you advance in Data Science, you will eventually stop asking colleagues to &quot;email you the export&quot; and start pulling data directly from the source: the company database. This is a major leap in efficiency. It ensures you are always working with the most current data and eliminates version control issues (e.g., sales_data_final_final_v2.xlsx). Reading from SQL requires two distinct steps: 1. Establish a Connection: You create a &quot;tunnel&quot; to the database using a connector library (like sqlite3 for local files, or sqlalchemy for enterprise databases like PostgreSQL or Oracle). 2. Query the Data: You send a SQL query through that tunnel, and Pandas converts the results into a DataFrame. Here is an example using sqlite3 (a lightweight database included with Python):</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pandas </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pd</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sqlite3</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Step 1: Establish the connection</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># In a real scenario, this would involve a host URL, username, and password</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">conn </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sqlite3.connect(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;company_database.db&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Step 2: Write your SQL query</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">query </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;&quot;&quot;</span></span></code></pre></div><p>SELECT customer_id, order_date, total_amount FROM orders WHERE order_date &gt;= &#39;2023-01-01&#39; &quot;&quot;&quot;</p><h1 id="step-3-read-the-result-directly-into-a-dataframe" tabindex="-1">Step 3: Read the result directly into a DataFrame <a class="header-anchor" href="#step-3-read-the-result-directly-into-a-dataframe" aria-label="Permalink to &quot;Step 3: Read the result directly into a DataFrame&quot;">â€‹</a></h1><p>df_sql = pd.read_sql(query, conn)</p><h1 id="step-4-close-the-connection-good-hygiene" tabindex="-1">Step 4: Close the connection (good hygiene!) <a class="header-anchor" href="#step-4-close-the-connection-good-hygiene" aria-label="Permalink to &quot;Step 4: Close the connection (good hygiene!)&quot;">â€‹</a></h1><p>conn.close() A diagram illustrating the &quot;Handshake&quot; process. On the left, a database server icon. On the right, the Pandas DataFrame. In the middle, a pipe labeled &quot;Connection Object&quot;. A piece of paper labeled &quot;SQL Query&quot; travels from right to left through the pipe, and a grid of data labeled &quot;Result Set&quot; travels back from left to right, transforming into a DataFrame.</p><p>A diagram illustrating the &quot;Handshake&quot; process. On the left, a database server icon. On the right, the Pandas DataFrame. In the middle, a pipe labeled &quot;Connection Object&quot;. A piece of paper labeled &quot;SQL Query&quot; travels from right to left through the pipe, and a grid of data labeled &quot;Result Set&quot; travels back from left to right, transforming into a DataFrame. By using pd.read_sql, you effectively outsource the heavy lifting of filtering and joining data to the database engineâ€”which is optimized for itâ€”before bringing the refined dataset into Python for analysis. Troubleshooting: The &quot;File Not Found&quot; Error The most common error you will encounter in this stage is FileNotFoundError. When you type pd.read_csv(&#39;data.csv&#39;), Python looks for that file in the current working directoryâ€”the folder where your script is currently running. If your script is in Documents/Scripts and your data is in Downloads, Python will not find it. You have two solutions: 1. Move the data: Place the CSV in the same folder as your script. 2. Use the absolute path: Tell Python exactly where the file is located on your hard drive.</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Windows Example (note the &#39;r&#39; before the string to handle backslashes)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pd.read_csv(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">r</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#DBEDFF;">C:</span><span style="--shiki-light:#22863A;--shiki-light-font-weight:bold;--shiki-dark:#85E89D;--shiki-dark-font-weight:bold;">\\U</span><span style="--shiki-light:#032F62;--shiki-dark:#DBEDFF;">sers</span><span style="--shiki-light:#22863A;--shiki-light-font-weight:bold;--shiki-dark:#85E89D;--shiki-dark-font-weight:bold;">\\Y</span><span style="--shiki-light:#032F62;--shiki-dark:#DBEDFF;">ourName</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\D</span><span style="--shiki-light:#032F62;--shiki-dark:#DBEDFF;">ownloads</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\d</span><span style="--shiki-light:#032F62;--shiki-dark:#DBEDFF;">ata</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">.</span><span style="--shiki-light:#032F62;--shiki-dark:#DBEDFF;">csv</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Mac/Linux Example</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pd.read_csv(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;/Users/YourName/Downloads/data.csv&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Ingestion is the first hurdle. Once your data is successfully loaded into a DataFrame, the variable df becomes your new workspace. You have left the static world of files and entered the dynamic world of programmatic analysis. Next, we need to inspect what we just loaded to ensure it looks the way we expect. Filtering, Selecting, and Slicing Subsets of Business Data Imagine opening a massive Excel workbook containing five years of global transaction data. It has fifty columns and a million rows. Your manager sends you a Slack message: &quot;I need a list of all &#39;Enterprise&#39; customers in the &#39;EMEA&#39; region who spent over $50,000 last quarter, and I only need their email addresses and total spend.&quot; In Excel, you would instinctively reach for the AutoFilter buttons (the little downward arrows at the top of columns). You would uncheck &quot;Select All,&quot; click &quot;Enterprise,&quot; scroll to the Region column, filter for &quot;EMEA,&quot; apply a number filter for the spend, and finally hide the 48 columns you don&#39;t need. This manual process works, but it is brittle. If the data updates tomorrow, you have to click through that sequence again. In Pandas, we perform these same actionsâ€”selecting specific columns and filtering for specific rowsâ€”using code. This allows us to save our &quot;clicks&quot; as a repeatable script. In this section, we will learn how to slice your DataFrame to extract exactly the subset of business data you need. Selecting Columns: The &quot;Vertical&quot; Slice The most basic operation in data analysis is ignoring the noise. If your dataset has 50 columns but you only need two, you shouldn&#39;t carry the weight of the other 48. In Pandas, selecting a column is done using bracket notation, similar to looking up a value in a Dictionary.</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pandas </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pd</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Sample business data</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">data </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;TransactionID&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">101</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">102</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">103</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">104</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">105</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;Customer&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Acme Corp&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Globex&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Soylent Corp&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Initech&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Umbrella Corp&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;Region&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;North&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;South&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;East&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;North&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;West&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;Sales&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">12000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">45000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">55000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">21000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;Status&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Closed&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Pending&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Closed&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Closed&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Pending&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pd.DataFrame(data)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Selecting a single column</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">customer_list </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> df[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Customer&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(customer_list)</span></span></code></pre></div><p><strong>Output:</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span></span></span>
<span class="line"><span>\`\`\`text</span></span>
<span class="line"><span>0       Acme Corp</span></span>
<span class="line"><span>1          Globex</span></span>
<span class="line"><span>2    Soylent Corp</span></span>
<span class="line"><span>3         Initech</span></span>
<span class="line"><span>4   Umbrella Corp</span></span></code></pre></div><p>Name: Customer, dtype: object Notice that the output doesn&#39;t look exactly like a table anymore. As discussed in previous sections, when you pull a single column out of a DataFrame, it becomes a Series (a one-dimensional labeled array). Selecting Multiple Columns To select multiple columnsâ€”for example, if you only want to see who purchased and how much they spentâ€”you must pass a list of column names inside the brackets. This is often called &quot;passing a list to the brackets,&quot; resulting in double brackets [[...]].</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Selecting a subset of columns</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">summary_view </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> df[[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Customer&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Sales&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]]</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(summary_view)</span></span></code></pre></div><p><strong>Output:</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span></span></span>
<span class="line"><span>\`\`\`text</span></span>
<span class="line"><span>Customer  Sales</span></span>
<span class="line"><span>0      Acme Corp  12000</span></span>
<span class="line"><span>1         Globex  45000</span></span>
<span class="line"><span>2   Soylent Corp   3000</span></span>
<span class="line"><span>3        Initech  55000</span></span>
<span class="line"><span>4  Umbrella Corp  21000</span></span></code></pre></div><p>Note: When selecting multiple columns, the result remains a DataFrame, not a Series. A visual comparison showing a full spreadsheet on the left. An arrow points to the right showing two distinct outputs: 1. A single column extracted as a &#39;Series&#39; (1D strip). 2. Two columns extracted as a smaller &#39;DataFrame&#39; (2D table).</p><h2 id="a-visual-comparison-showing-a-full-spreadsheet-on-the-left-an-arrow-points-to-the-right-showing-two-distinct-outputs-1-a-single-column-extracted-as-a-series-1d-strip-2-two-columns-extracted-as-a-smaller-dataframe-2d-table" tabindex="-1">A visual comparison showing a full spreadsheet on the left. An arrow points to the right showing two distinct outputs: 1. A single column extracted as a &#39;Series&#39; (1D strip). 2. Two columns extracted as a smaller &#39;DataFrame&#39; (2D table). <a class="header-anchor" href="#a-visual-comparison-showing-a-full-spreadsheet-on-the-left-an-arrow-points-to-the-right-showing-two-distinct-outputs-1-a-single-column-extracted-as-a-series-1d-strip-2-two-columns-extracted-as-a-smaller-dataframe-2d-table" aria-label="Permalink to &quot;A visual comparison showing a full spreadsheet on the left. An arrow points to the right showing two distinct outputs: 1. A single column extracted as a &#39;Series&#39; (1D strip). 2. Two columns extracted as a smaller &#39;DataFrame&#39; (2D table).&quot;">â€‹</a></h2><p>Slicing Rows: loc and iloc While selecting columns is straightforward (by name), selecting rows is slightly more nuanced. In Excel, you refer to rows by their number (Row 5, Row 10). In Pandas, we have two ways to access rows: by their Label or by their Integer Position. This distinction is handled by two indexers: .loc and .iloc.</p><ol><li>iloc (Integer Location) Think of iloc as the &quot;Excel Row Number&quot; method. It relies strictly on the order of the data, regardless of what the row is actually named. It is 0-indexed (counting starts at 0).</li></ol><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Select the first row (Index 0)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">first_transaction </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> df.iloc[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Select the first three rows (Index 0 up to, but not including, 3)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">first_batch </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> df.iloc[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">. loc (Label Location) loc </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">is</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> used when you want to select data based on the Index Label. By default, a DataFrame has a numeric index (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), so loc </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">and</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> iloc might look similar. However, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> business data, we often </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> a meaningful </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ID</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> the index, such </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> a TransactionID </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">or</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Date.</span></span></code></pre></div><p>Let&#39;s set TransactionID as our index to see the difference.</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Set TransactionID as the index</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df_indexed </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> df.set_index(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;TransactionID&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Use loc to find the row labeled &#39;104&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">initech_sale </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> df_indexed.loc[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">104</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(initech_sale)</span></span></code></pre></div><p><strong>Output:</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span></span></span>
<span class="line"><span>\`\`\`text</span></span>
<span class="line"><span>Customer    Initech</span></span>
<span class="line"><span>Region        North</span></span>
<span class="line"><span>Sales         55000</span></span>
<span class="line"><span>Status       Closed</span></span></code></pre></div><p>Name: 104, dtype: object If we had tried to use df_indexed.iloc[104], Python would throw an error because there is no 105th row (positionally) in our small dataset. A diagram explaining <code>.iloc</code> vs <code>.loc</code>. The visual shows a DataFrame with a &#39;TransactionID&#39; index (101, 102, 103...). On the left side, a ruler measures &#39;Position&#39; (0, 1, 2) labeled &quot;iloc&quot;. On the right side, tags point to the specific IDs (101, 102) labeled &quot;loc&quot;.</p><h2 id="a-diagram-explaining-iloc-vs-loc-the-visual-shows-a-dataframe-with-a-transactionid-index-101-102-103-on-the-left-side-a-ruler-measures-position-0-1-2-labeled-iloc-on-the-right-side-tags-point-to-the-specific-ids-101-102-labeled-loc" tabindex="-1">A diagram explaining <code>.iloc</code> vs <code>.loc</code>. The visual shows a DataFrame with a &#39;TransactionID&#39; index (101, 102, 103...). On the left side, a ruler measures &#39;Position&#39; (0, 1, 2) labeled &quot;iloc&quot;. On the right side, tags point to the specific IDs (101, 102) labeled &quot;loc&quot;. <a class="header-anchor" href="#a-diagram-explaining-iloc-vs-loc-the-visual-shows-a-dataframe-with-a-transactionid-index-101-102-103-on-the-left-side-a-ruler-measures-position-0-1-2-labeled-iloc-on-the-right-side-tags-point-to-the-specific-ids-101-102-labeled-loc" aria-label="Permalink to &quot;A diagram explaining \`.iloc\` vs \`.loc\`. The visual shows a DataFrame with a &#39;TransactionID&#39; index (101, 102, 103...). On the left side, a ruler measures &#39;Position&#39; (0, 1, 2) labeled &quot;iloc&quot;. On the right side, tags point to the specific IDs (101, 102) labeled &quot;loc&quot;.&quot;">â€‹</a></h2><p>Boolean Indexing: Filtering with &quot;Business Logic&quot; Selecting rows by ID is useful for lookups, but the real power of Data Science lies in Filtering. This is the equivalent of asking: &quot;Show me all rows WHERE Sales &gt; 20,000.&quot; In Pandas, this is called Boolean Indexing. It works in a three-step logic process, though we usually write it in one line. Step 1: The Condition First, Pandas asks a question of every row in the column.</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># The Question: Is Sales greater than 20,000?</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">mask </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> df[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Sales&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 20000</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(mask)</span></span></code></pre></div><p><strong>Output:</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span></span></span>
<span class="line"><span>\`\`\`text</span></span>
<span class="line"><span>0    False</span></span>
<span class="line"><span>1     True</span></span>
<span class="line"><span>2    False</span></span>
<span class="line"><span>3     True</span></span>
<span class="line"><span>4     True</span></span></code></pre></div><p>Name: Sales, dtype: bool Pandas returns a Series of True and False values. This is often called a Boolean Mask. Step 2: Applying the Mask We now overlay this &quot;Truth Mask&quot; onto our DataFrame. Pandas will keep the rows where the mask is True and discard the rows where it is False.</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Apply the mask to the dataframe</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">high_value_sales </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> df[mask]</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># OR, typically written in a single line:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">high_value_sales </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> df[df[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Sales&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 20000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(high_value_sales)</span></span></code></pre></div><p><strong>Output:</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span></span></span>
<span class="line"><span>\`\`\`text</span></span></code></pre></div><p>TransactionID Customer Region Sales Status 1 102 Globex South 45000 Pending 3 104 Initech North 55000 Closed 4 105 Umbrella Corp West 21000 Pending A flowchart illustrating Boolean Indexing. Top layer: Original DataFrame. Middle layer: A semi-transparent &quot;Mask&quot; showing True/False values corresponding to rows. Bottom layer: The Resulting DataFrame, containing only the rows that aligned with &quot;True&quot;.</p><h2 id="a-flowchart-illustrating-boolean-indexing-top-layer-original-dataframe-middle-layer-a-semi-transparent-mask-showing-true-false-values-corresponding-to-rows-bottom-layer-the-resulting-dataframe-containing-only-the-rows-that-aligned-with-true" tabindex="-1">A flowchart illustrating Boolean Indexing. Top layer: Original DataFrame. Middle layer: A semi-transparent &quot;Mask&quot; showing True/False values corresponding to rows. Bottom layer: The Resulting DataFrame, containing only the rows that aligned with &quot;True&quot;. <a class="header-anchor" href="#a-flowchart-illustrating-boolean-indexing-top-layer-original-dataframe-middle-layer-a-semi-transparent-mask-showing-true-false-values-corresponding-to-rows-bottom-layer-the-resulting-dataframe-containing-only-the-rows-that-aligned-with-true" aria-label="Permalink to &quot;A flowchart illustrating Boolean Indexing. Top layer: Original DataFrame. Middle layer: A semi-transparent &quot;Mask&quot; showing True/False values corresponding to rows. Bottom layer: The Resulting DataFrame, containing only the rows that aligned with &quot;True&quot;.&quot;">â€‹</a></h2><p>Combining Multiple Conditions (AND / OR) Real-world business questions are rarely simple. You might need to filter for sales that are high value AND closed. In Excel, you might nest an AND() function. In Python, we use bitwise operators: <code>&amp;</code> for AND (Both conditions must be true) <code>|</code> for OR (At least one condition must be true) Crucial Syntax Rule: When combining conditions in Pandas, you must wrap each condition in parentheses ().</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Goal: Find Closed deals with Sales over 10,000</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Incorrect: df[df[&#39;Status&#39;] == &#39;Closed&#39; &amp; df[&#39;Sales&#39;] &gt; 10000] -&gt; ERROR</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Correct: Parentheses around each logic check</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">closed_high_value </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> df[(df[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Status&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;Closed&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (df[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Sales&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 10000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)]</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(closed_high_value)</span></span></code></pre></div><p><strong>Output:</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span></span></span>
<span class="line"><span>\`\`\`text</span></span></code></pre></div><p>TransactionID Customer Region Sales Status 0 101 Acme Corp North 12000 Closed 3 104 Initech North 55000 Closed Summary: The &quot;Data Science&quot; Way vs. The &quot;Spreadsheet&quot; Way You have now moved from clicking arrows to writing logic. While it may feel like more typing initially, consider the scalability:</p><ol><li>Auditability: In Excel, it is hard to see what is currently filtered just by looking at the grid. In Python, the code df[df[&#39;Sales&#39;] &gt; 20000] explicitly states your criteria. 2. Reusability: You can copy this code snippet and apply it to next month&#39;s sales file without clicking a single button. 3. Complexity: You can chain complex logic (e.g., &quot;Sales &gt; 50k OR (Sales &gt; 20k AND Region is North)&quot;) that would be a nightmare to manage in standard spreadsheet filters. In the next section, we will look at how to modify this data once we have selected it, cleaning up messy inputs and creating new calculated columns. Aggregating Metrics: GroupBy and Pivot Tables for Reporting If filtering, which we covered in the previous section, is about finding specific needles in a haystack, aggregation is about weighing the haystacks, measuring their volume, and comparing them against one another. In the business world, raw transactional data is rarely the final deliverable. Your stakeholders donâ€™t want to see a list of 50,000 individual coffee sales; they want to know the Total Revenue by Region, or the Average Transaction Value by Store Manager. In Excel, you solve this with the absolute workhorse of business analytics: the Pivot Table. It is likely the tool you use most often to summarize data. In Pandas, we achieve this same resultâ€”often with more power and flexibilityâ€”using the groupby method and pivot_table functions. The &quot;Split-Apply-Combine&quot; Strategy Before writing code, it is helpful to visualize what happens mechanically when you summarize data. The creators of Pandas built these tools around a philosophy called Split-Apply-Combine.</li><li>Split: You break the data into smaller groups based on certain criteria (e.g., separating rows by &quot;Region&quot;). 2. Apply: You apply a function to each independent group (e.g., Summing the &quot;Sales&quot; column or Counting the &quot;Order IDs&quot;). 3. Combine: You stitch the results back together into a new, clean table. A diagram illustrating the Split-Apply-Combine process. On the left, a colorful table representing raw data. In the middle, the table is split into three smaller tables separated by color (Red group, Blue group, Green group). An arrow points to calculation boxes (Sum) for each group. On the right, a final summary table combining the results of those sums.</li></ol><p>A diagram illustrating the Split-Apply-Combine process. On the left, a colorful table representing raw data. In the middle, the table is split into three smaller tables separated by color (Red group, Blue group, Green group). An arrow points to calculation boxes (Sum) for each group. On the right, a final summary table combining the results of those sums. In Excel, this happens instantly when you drag a field into the &quot;Rows&quot; box of a Pivot Table. In Python, we explicitly tell Pandas to perform these steps. The groupby Method The groupby method is the primary way to achieve the &quot;Split&quot; step. Letâ€™s imagine a simple dataset representing software sales.</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pandas </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pd</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Creating a sample dataset</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">data </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;Sales_Rep&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Sarah&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Mike&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Sarah&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Mike&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Sarah&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Jessica&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;Region&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;East&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;West&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;East&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;West&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;North&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;North&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;Product&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Software&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Software&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Consulting&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Hardware&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Software&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Hardware&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;Revenue&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">6000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">7000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">df </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pd.DataFrame(data)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(df)</span></span></code></pre></div><p>If we want to calculate the total revenue generated by each Sales Representative, we chain the operations together:</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Group by &#39;Sales_Rep&#39; and sum the &#39;Revenue&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">rep_performance </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> df.groupby(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Sales_Rep&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Revenue&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">].sum()</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(rep_performance)</span></span></code></pre></div><p><strong>Output:</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span></span></span>
<span class="line"><span>\`\`\`text</span></span>
<span class="line"><span>Sales_Rep</span></span>
<span class="line"><span>Jessica     7000</span></span>
<span class="line"><span>Mike       10000</span></span>
<span class="line"><span>Sarah      12000</span></span></code></pre></div><p>Name: Revenue, dtype: int64 Notice the syntax structure: 1. df.groupby(&#39;Sales_Rep&#39;): This splits the data. 2. [&#39;Revenue&#39;]: This selects the specific column we want to do math on. 3. .sum(): This is the function we apply. You are not limited to summing data. You can use .mean() (average), .count() (frequency), .min(), .max(), or .std() (standard deviation). Grouping by Multiple Columns In Excel, you often drag multiple fields into the &quot;Rows&quot; area of a Pivot Table to create a hierarchy (e.g., Region first, then Sales Rep). In Pandas, you simply pass a list of column names to the groupby method.</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Total Revenue by Region AND Product type</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">regional_mix </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> df.groupby([</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Region&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Product&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Revenue&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">].sum()</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(regional_mix)</span></span></code></pre></div><p><strong>Output:</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span></span></span>
<span class="line"><span>\`\`\`text</span></span>
<span class="line"><span>Region  Product   </span></span>
<span class="line"><span>East    Consulting    2000</span></span>
<span class="line"><span>        Software      5000</span></span>
<span class="line"><span>North   Hardware      7000</span></span>
<span class="line"><span>        Software      5000</span></span>
<span class="line"><span>West    Hardware      6000</span></span>
<span class="line"><span>        Software      4000</span></span></code></pre></div><p>Name: Revenue, dtype: int64 Advanced Aggregation: The .agg() Method Sometimes, a manager asks for a complex report: &quot;I need the Total Revenue per region, but I also need to know the Average Sale Price and the Number of Transactions.&quot; In Excel, you would drag the &quot;Revenue&quot; field into the &quot;Values&quot; box three times and change the field settings for each. In Pandas, we use the .agg() (aggregation) method to apply multiple functions at once.</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">summary_stats </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> df.groupby(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Region&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Revenue&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">].agg([</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;sum&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;mean&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;count&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(summary_stats)</span></span></code></pre></div><p><strong>Output:</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span></span></span>
<span class="line"><span>\`\`\`text</span></span>
<span class="line"><span>sum    mean  count</span></span>
<span class="line"><span>Region</span></span></code></pre></div><p>East 7000 3500.0 2 North 12000 6000.0 2 West 10000 5000.0 2 This creates a professional summary table in a single line of code. Creating Matrix Views with pivot_table While groupby is powerful, the output often looks like a long list. Sometimes, for reporting, you need a matrix layoutâ€”where one variable is on the rows and another is on the columns. This is the classic &quot;Pivot Table&quot; look. Pandas has a specific function for this: pivot_table. It closely mimics the parameters you interact with in Excel&#39;s Pivot Table menu. A split screenshot. On the left, the Excel Pivot Table Field List sidebar with arrows pointing to &quot;Rows&quot;, &quot;Columns&quot;, and &quot;Values&quot;. On the right, a Python code snippet of <code>pd.pivot_table</code> with arrows mapping the arguments <code>index=</code>, <code>columns=</code>, and <code>values=</code> to the corresponding Excel areas.</p><p>A split screenshot. On the left, the Excel Pivot Table Field List sidebar with arrows pointing to &quot;Rows&quot;, &quot;Columns&quot;, and &quot;Values&quot;. On the right, a Python code snippet of <code>pd.pivot_table</code> with arrows mapping the arguments <code>index=</code>, <code>columns=</code>, and <code>values=</code> to the corresponding Excel areas. Letâ€™s look at the parameters: Values: What creates the numbers inside the table? (Excel: Values area) Index: What defines the rows? (Excel: Rows area) Columns: What defines the headers? (Excel: Columns area) Aggfunc: How do we calculate the math? (defaults to mean, but we usually want sum)</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">matrix_report </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pd.pivot_table(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    df, </span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    values</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Revenue&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    index</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Region&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    columns</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Product&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    aggfunc</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;sum&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    fill_value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # Replace NaN (missing values) with 0</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(matrix_report)</span></span></code></pre></div><p><strong>Output:</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span></span></span>
<span class="line"><span>\`\`\`text</span></span></code></pre></div><p>Product Consulting Hardware Software Region<br> East 2000 0 5000 North 0 7000 5000 West 0 6000 4000 By setting fill_value=0, we handled a common issue: The &quot;East&quot; region had no &quot;Hardware&quot; sales. Without this argument, Pandas would display NaN (Not a Number). Setting it to 0 makes the report clean and ready for presentation. The &quot;Reset Index&quot; Trick A common frustration for career switchers occurs immediately after using groupby. When you group data, the columns you grouped by (e.g., &#39;Region&#39;) become the Index of the DataFrame, not standard columns. This makes them harder to manipulate if you want to export the data or perform further plotting. To fix this, we use .reset_index(). This pushes the index back into the DataFrame as a standard column. Think of it as &quot;flattening&quot; the Pivot Table back into a regular list.</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Without reset_index (Region is the index)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">grouped </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> df.groupby(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Region&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Revenue&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">].sum()</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># With reset_index (Region becomes a normal column again)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">flat_data </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> grouped.reset_index()</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(flat_data)</span></span></code></pre></div><p><strong>Output:</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span></span></span>
<span class="line"><span>\`\`\`text</span></span>
<span class="line"><span>Region  Revenue</span></span>
<span class="line"><span>0   East     7000</span></span>
<span class="line"><span>1  North    12000</span></span>
<span class="line"><span>2   West    10000</span></span></code></pre></div><p>By mastering groupby and pivot_table, you no longer need to rely on fragile Excel files where one accidental keystroke inside a Pivot calculation can ruin a monthly report. You now have reproducible, auditable code that can generate complex metrics from millions of rows in seconds.</p>`,89)])])}const g=a(n,[["render",l]]);export{c as __pageData,g as default};
